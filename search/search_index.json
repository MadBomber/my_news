{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"MyNews","text":"<p>A Ruby gem that transforms 200+ RSS feeds into themed bulletins published 3x daily. The pipeline fetches, normalizes, summarizes (via LLM), deduplicates, and publishes \u2014 outputting to both FreshRSS and local Markdown/HTML files.</p>      Your browser does not support the video tag.    Key Features <li> Async concurrent fetching with ETag caching and rate limiting <li> Full-text extraction and HTML-to-Markdown normalization <li> LLM-powered summarization (OpenAI, Anthropic, Gemini via `ruby_llm`) <li> SimHash deduplication and recurring topic detection <li> Themed bulletin assembly with scheduled publishing <li> FreshRSS Fever API integration <li> SQLite persistence with FTS5 full-text search Mli&gt; Proxy support for restricted feeds"},{"location":"#pipeline","title":"Pipeline","text":"FETCH \u25b6 NORMALIZE \u25b6 SUMMARIZE \u25b6 CLUSTER \u25b6 PUBLISH Stage What it does Fetch Async HTTP with ETag caching, rate limiting, Tor proxy support Normalize Readability full-text extraction, HTML-to-Markdown conversion Summarize LLM summarization via <code>ruby_llm</code> (OpenAI, Anthropic, Gemini) Cluster SimHash deduplication, recurring topic detection Publish Themed bulletin assembly, FreshRSS Fever API, Markdown+HTML output"},{"location":"#quick-links","title":"Quick Links","text":"<ul> <li>Installation -- get up and running</li> <li>Quick Start -- first pipeline run</li> <li>CLI Reference -- all commands</li> <li>Configuration -- defaults.yml, feeds.yml, bulletins.yml</li> <li>API Reference -- module documentation</li> <li>Examples -- 7 runnable examples</li> </ul>"},{"location":"#requirements","title":"Requirements","text":"<ul> <li>Ruby &gt;= 3.2.0</li> <li>SQLite3</li> <li>LLM API key (OpenAI, Anthropic, or Gemini) for summarization</li> </ul>"},{"location":"api/","title":"API Reference","text":"<p>Module-level documentation for the MyNews gem.</p>"},{"location":"api/#modules","title":"Modules","text":"Module Description Fetch Async feed fetching with caching and handlers Normalize Full-text extraction and HTML-to-Markdown conversion Summarize LLM-powered article summarization Cluster SimHash deduplication and recurring topic detection Publish Bulletin assembly, file output, FreshRSS integration Models Sequel models for Feed, Entry, Article, Bulletin"},{"location":"api/#top-level","title":"Top-Level","text":"<pre><code>MyNews.setup                  # Initialize database and configuration\nMyNews.setup(db_path: \"...\")  # Custom database path\nMyNews.db                     # Sequel database connection\nMyNews.config                 # Configuration object\n</code></pre>"},{"location":"api/cluster/","title":"Cluster API","text":"<p><code>lib/my_news/cluster/</code></p>"},{"location":"api/cluster/#simhash","title":"Simhash","text":"<p><code>MyNews::Cluster::Simhash</code></p> <p>Computes 64-bit SimHash fingerprints from text content. Used for near-duplicate detection.</p> <pre><code>fingerprint = MyNews::Cluster::Simhash.compute(\"article text here\")\n# =&gt; Integer (64-bit)\n</code></pre>"},{"location":"api/cluster/#deduplicator","title":"Deduplicator","text":"<p><code>MyNews::Cluster::Deduplicator</code></p> <p>Groups articles by SimHash hamming distance and assigns <code>cluster_id</code> values.</p> <pre><code>MyNews::Cluster::Deduplicator.new.call\n</code></pre>"},{"location":"api/cluster/#recurrence","title":"Recurrence","text":"<p><code>MyNews::Cluster::Recurrence</code></p> <p>Detects topics that recur across multiple days by comparing today's clusters against the last 3 days.</p> <pre><code>MyNews::Cluster::Recurrence.new.call\n</code></pre> <p>Sets <code>is_recurring = true</code> on matching articles.</p>"},{"location":"api/fetch/","title":"Fetch API","text":"<p><code>lib/my_news/fetch/</code></p>"},{"location":"api/fetch/#fetcher","title":"Fetcher","text":"<p><code>MyNews::Fetch::Fetcher</code></p> <p>Orchestrates concurrent feed fetching using <code>async-http</code>.</p> <pre><code>fetcher = MyNews::Fetch::Fetcher.new\nresults = fetcher.call\n# =&gt; { feed_id =&gt; { status: :ok, new_entries: 5 }, ... }\n</code></pre> <p>Behavior:</p> <ul> <li>Loads enabled feeds from the database</li> <li>Fetches concurrently (configurable via <code>fetch.concurrency</code>)</li> <li>Sends <code>If-None-Match</code> / <code>If-Modified-Since</code> headers for ETag caching</li> <li>Delegates to per-feed handlers when configured</li> <li>Stores new entries in the <code>entries</code> table</li> </ul>"},{"location":"api/fetch/#torproxy","title":"TorProxy","text":"<p><code>MyNews::Fetch::TorProxy</code></p> <p>SOCKS5 proxy wrapper for routing requests through Tor.</p> <p>Configured via <code>fetch.tor.enabled</code>, <code>fetch.tor.host</code>, <code>fetch.tor.port</code> in defaults.yml.</p>"},{"location":"api/fetch/#handlers","title":"Handlers","text":"<p><code>MyNews::Fetch::Handlers</code></p>"},{"location":"api/fetch/#base","title":"Base","text":"<p><code>MyNews::Fetch::Handlers::Base</code> -- abstract base class for custom feed handlers.</p>"},{"location":"api/fetch/#hackernews","title":"HackerNews","text":"<p><code>MyNews::Fetch::Handlers::HackerNews</code> -- extracts linked article URLs from HN RSS items and fetches full content.</p>"},{"location":"api/fetch/#mastodon","title":"Mastodon","text":"<p><code>MyNews::Fetch::Handlers::Mastodon</code> -- handles Mastodon/Fediverse feed items.</p>"},{"location":"api/models/","title":"Models","text":"<p><code>lib/my_news/models/</code></p> <p>All models use <code>Sequel::Model</code>.</p>"},{"location":"api/models/#feed","title":"Feed","text":"<p><code>MyNews::Models::Feed</code></p> Column Type Description <code>id</code> Integer Primary key <code>url</code> Text Feed URL (unique) <code>name</code> Text Display name <code>handler</code> Text Custom handler name <code>etag</code> Text Last ETag header <code>last_modified</code> Text Last-Modified header <code>last_fetched_at</code> Text Timestamp of last fetch <code>enabled</code> Integer 1 = enabled, 0 = disabled <p>Associations: <code>one_to_many :entries</code></p> <p>Scopes: <code>.enabled</code> -- feeds where <code>enabled = 1</code></p>"},{"location":"api/models/#entry","title":"Entry","text":"<p><code>MyNews::Models::Entry</code></p> Column Type Description <code>id</code> Integer Primary key <code>feed_id</code> Integer Foreign key to feeds <code>guid</code> Text Unique entry identifier <code>title</code> Text Entry title <code>url</code> Text Entry URL <code>raw_html</code> Text Raw HTML content <code>fetched_at</code> Text When the entry was fetched <p>Associations: <code>many_to_one :feed</code>, <code>one_to_one :article</code></p>"},{"location":"api/models/#article","title":"Article","text":"<p><code>MyNews::Models::Article</code></p> Column Type Description <code>id</code> Integer Primary key <code>entry_id</code> Integer Foreign key to entries (unique) <code>markdown</code> Text Normalized markdown content <code>summary</code> Text LLM-generated summary <code>simhash</code> Integer 64-bit SimHash fingerprint <code>cluster_id</code> Integer Duplicate cluster group <code>is_recurring</code> Integer 1 if recurring topic <code>processed_at</code> Text When the article was processed <p>Associations: <code>many_to_one :entry</code></p>"},{"location":"api/models/#bulletin","title":"Bulletin","text":"<p><code>MyNews::Models::Bulletin</code></p> Column Type Description <code>id</code> Integer Primary key <code>theme</code> Text Bulletin theme name <code>content_md</code> Text Markdown content <code>content_html</code> Text HTML content <code>published_at</code> Text Publication timestamp <code>pushed_freshrss</code> Integer 1 if pushed to FreshRSS"},{"location":"api/normalize/","title":"Normalize API","text":"<p><code>lib/my_news/normalize/</code></p>"},{"location":"api/normalize/#normalizer","title":"Normalizer","text":"<p><code>MyNews::Normalize::Normalizer</code></p> <p>Orchestrates the normalization of raw HTML entries into Markdown articles.</p> <pre><code>normalizer = MyNews::Normalize::Normalizer.new\ncount = normalizer.call\n# =&gt; number of articles created\n</code></pre>"},{"location":"api/normalize/#extractor","title":"Extractor","text":"<p><code>MyNews::Normalize::Extractor</code></p> <p>Uses the Readability algorithm (via Nokogiri) to extract the main content from HTML pages, stripping navigation, ads, and boilerplate.</p>"},{"location":"api/normalize/#converter","title":"Converter","text":"<p><code>MyNews::Normalize::Converter</code></p> <p>Converts clean HTML to Markdown using the <code>reverse_markdown</code> gem.</p>"},{"location":"api/publish/","title":"Publish API","text":"<p><code>lib/my_news/publish/</code></p>"},{"location":"api/publish/#publisher","title":"Publisher","text":"<p><code>MyNews::Publish::Publisher</code></p> <p>Orchestrates the full publish stage: bulletin building, file writing, and FreshRSS push.</p> <pre><code>publisher = MyNews::Publish::Publisher.new\npublisher.call\n</code></pre>"},{"location":"api/publish/#bulletinbuilder","title":"BulletinBuilder","text":"<p><code>MyNews::Publish::BulletinBuilder</code></p> <p>Assembles themed bulletins from clustered articles. Groups articles by theme keywords, places recurring topics at the end.</p>"},{"location":"api/publish/#filewriter","title":"FileWriter","text":"<p><code>MyNews::Publish::FileWriter</code></p> <p>Writes bulletin content to Markdown and HTML files in the configured output directories.</p>"},{"location":"api/publish/#freshrss","title":"Freshrss","text":"<p><code>MyNews::Publish::Freshrss</code></p> <p>Pushes bulletins to FreshRSS via the Fever API using Faraday HTTP POST requests.</p>"},{"location":"api/publish/#scheduler","title":"Scheduler","text":"<p><code>MyNews::Publish::Scheduler</code></p> <p>Runs the full pipeline on a cron schedule using <code>rufus-scheduler</code>.</p> <pre><code>scheduler = MyNews::Publish::Scheduler.new\nscheduler.start  # Blocks, runs pipeline at configured times\n</code></pre>"},{"location":"api/summarize/","title":"Summarize API","text":"<p><code>lib/my_news/summarize/</code></p>"},{"location":"api/summarize/#summarizer","title":"Summarizer","text":"<p><code>MyNews::Summarize::Summarizer</code></p> <p>Orchestrates LLM-based article summarization.</p> <pre><code>summarizer = MyNews::Summarize::Summarizer.new\nsummarizer.call\n</code></pre> <p>Processes all articles without a summary, calling the configured LLM provider via <code>ruby_llm</code>.</p>"},{"location":"api/summarize/#llmconfig","title":"LlmConfig","text":"<p><code>MyNews::Summarize::LlmConfig</code></p> <p>Sets up <code>RubyLLM</code> with API keys from environment variables:</p> <pre><code>MyNews::Summarize::LlmConfig.setup(config)\n</code></pre> <p>Reads <code>OPENAI_API_KEY</code>, <code>ANTHROPIC_API_KEY</code>, and <code>GEMINI_API_KEY</code> from the environment.</p>"},{"location":"architecture/","title":"Architecture","text":"<p>MyNews follows a pipeline architecture with five discrete stages, each independently runnable via CLI.</p> <ul> <li>Pipeline -- detailed stage-by-stage flow</li> <li>Database -- SQLite schema, FTS5 search, Sequel ORM usage</li> </ul>"},{"location":"architecture/database/","title":"Database","text":"<p>MyNews uses SQLite via the Sequel ORM with FTS5 full-text search.</p>"},{"location":"architecture/database/#schema","title":"Schema","text":"<pre><code>CREATE TABLE feeds (\n  id INTEGER PRIMARY KEY,\n  url TEXT NOT NULL UNIQUE,\n  name TEXT,\n  handler TEXT,\n  etag TEXT,\n  last_modified TEXT,\n  last_fetched_at TEXT,\n  enabled INTEGER DEFAULT 1\n);\n\nCREATE TABLE entries (\n  id INTEGER PRIMARY KEY,\n  feed_id INTEGER REFERENCES feeds(id),\n  guid TEXT NOT NULL,\n  title TEXT,\n  url TEXT,\n  raw_html TEXT,\n  fetched_at TEXT NOT NULL,\n  UNIQUE(feed_id, guid)\n);\n\nCREATE TABLE articles (\n  id INTEGER PRIMARY KEY,\n  entry_id INTEGER REFERENCES entries(id) UNIQUE,\n  markdown TEXT NOT NULL,\n  summary TEXT,\n  simhash INTEGER,\n  cluster_id INTEGER,\n  is_recurring INTEGER DEFAULT 0,\n  processed_at TEXT NOT NULL\n);\n\nCREATE VIRTUAL TABLE articles_fts USING fts5(\n  title, markdown, summary,\n  content='articles',\n  content_rowid='id',\n  tokenize='porter'\n);\n\nCREATE TABLE bulletins (\n  id INTEGER PRIMARY KEY,\n  theme TEXT NOT NULL,\n  content_md TEXT,\n  content_html TEXT,\n  published_at TEXT,\n  pushed_freshrss INTEGER DEFAULT 0\n);\n</code></pre>"},{"location":"architecture/database/#fts5-full-text-search","title":"FTS5 Full-Text Search","text":"<p>The <code>articles_fts</code> virtual table provides Porter-stemmed full-text search across article titles, markdown content, and summaries.</p> <pre><code># Search via Sequel\nMyNews.db[:articles_fts]\n  .where(Sequel.lit(\"articles_fts MATCH ?\", \"ruby performance\"))\n  .limit(10)\n  .select(:rowid, :title, :summary)\n  .all\n</code></pre> <p>Or via CLI:</p> <pre><code>my_news search \"ruby performance\" --limit 20\n</code></pre>"},{"location":"architecture/database/#sequel-orm","title":"Sequel ORM","text":"<p>Models use <code>Sequel::Model</code> and live in <code>lib/my_news/models/</code>:</p> <ul> <li><code>MyNews::Models::Feed</code></li> <li><code>MyNews::Models::Entry</code></li> <li><code>MyNews::Models::Article</code></li> <li><code>MyNews::Models::Bulletin</code></li> </ul>"},{"location":"architecture/pipeline/","title":"Pipeline Architecture","text":""},{"location":"architecture/pipeline/#overview","title":"Overview","text":"FETCH Load feeds from config \u25bc Async HTTP requests \u25bc ETag / Last-Modified caching \u25bc Parse RSS / Atom XML \u25bc Store entries in SQLite NORMALIZE Load unprocessed entries \u25bc Readability extraction \u25bc HTML \u2192 Markdown \u25bc Create Article records SUMMARIZE Load unsummarized articles \u25bc Build LLM prompt \u25bc Call provider via ruby_llm \u25bc Store summary on article CLUSTER Compute SimHash fingerprints \u25bc Group by hamming distance \u25bc Assign cluster IDs \u25bc Detect recurring topics PUBLISH Group articles by theme \u25bc Build bulletin content \u25bc Write Markdown + HTML files \u25bc Push to FreshRSS via Fever API"},{"location":"architecture/pipeline/#stage-details","title":"Stage Details","text":""},{"location":"architecture/pipeline/#fetch","title":"Fetch","text":"<ul> <li>Uses <code>async</code> and <code>async-http</code> for concurrent requests (default: 10 concurrent)</li> <li>Respects <code>ETag</code> and <code>Last-Modified</code> headers to skip unchanged feeds</li> <li>Custom handlers for sites needing special parsing (Hacker News, Mastodon)</li> <li>Optional Tor SOCKS5 proxy support</li> <li>Stores raw HTML entries in the <code>entries</code> table</li> </ul>"},{"location":"architecture/pipeline/#normalize","title":"Normalize","text":"<ul> <li>Extracts full-text content using Readability algorithm via <code>nokogiri</code></li> <li>Converts clean HTML to Markdown using <code>reverse_markdown</code></li> <li>Creates <code>Article</code> records linked back to source <code>Entry</code></li> </ul>"},{"location":"architecture/pipeline/#summarize","title":"Summarize","text":"<ul> <li>Uses <code>ruby_llm</code> gem for unified access to OpenAI, Anthropic, and Gemini</li> <li>Applies an Economist-style editor system prompt</li> <li>Generates concise summaries stored on each <code>Article</code></li> </ul>"},{"location":"architecture/pipeline/#cluster","title":"Cluster","text":"<ul> <li>Computes 64-bit SimHash fingerprints from article text</li> <li>Groups articles by hamming distance threshold</li> <li>Assigns <code>cluster_id</code> to duplicate groups</li> <li>Detects recurring topics by comparing against articles from the last 3 days</li> </ul>"},{"location":"architecture/pipeline/#publish","title":"Publish","text":"<ul> <li>Groups articles into themed bulletins based on <code>bulletins.yml</code> configuration</li> <li>Recurring topics placed at the end of each bulletin</li> <li>Writes Markdown and HTML output files</li> <li>Pushes bulletins to FreshRSS via the Fever API</li> </ul>"},{"location":"architecture/pipeline/#design-decisions","title":"Design Decisions","text":"Decision Rationale <code>ruby_llm</code> gem Single gem for all LLM providers; no custom adapter code Sequel over ActiveRecord Lighter weight, better FTS5 support, no Rails dependency <code>async</code> gem over threads Structured concurrency via Fibers for 200+ HTTP requests Pure Ruby SimHash Avoids native dependencies; 64-bit fingerprint is fast enough for hundreds of articles Discrete CLI commands Each pipeline stage independently runnable or chained via <code>pipeline</code> Fever API for FreshRSS Simple HTTP POST, no special client needed"},{"location":"cli/","title":"CLI Reference","text":"<p>MyNews provides a Thor-based CLI. All commands are invoked as <code>my_news &lt;command&gt;</code>.</p>"},{"location":"cli/#pipeline-commands","title":"Pipeline Commands","text":"Command Description <code>fetch</code> Fetch all enabled RSS feeds <code>normalize</code> Convert raw entries to markdown articles <code>summarize</code> Summarize articles via LLM <code>cluster</code> Deduplicate and detect recurring topics <code>publish</code> Build and publish themed bulletins <code>pipeline</code> Run full pipeline: fetch, normalize, summarize, cluster, publish <code>schedule</code> Run the full pipeline on a cron schedule (3x/day by default)"},{"location":"cli/#search","title":"Search","text":"<pre><code>my_news search QUERY [--limit N]\n</code></pre> <p>Full-text search across articles using FTS5. Default limit is 10 results.</p>"},{"location":"cli/#feed-management","title":"Feed Management","text":"Command Description <code>feeds [--all]</code> List all feeds and their status <code>feed_add URL [--name NAME] [--handler HANDLER]</code> Add a new feed <code>feed_remove URL</code> Remove a feed and its entries <code>feed_toggle URL</code> Enable or disable a feed"},{"location":"cli/#status","title":"Status","text":"<pre><code>my_news status\n</code></pre> <p>Displays pipeline statistics:</p> <ul> <li>Feed counts (enabled/total)</li> <li>Entry, article, bulletin counts</li> <li>Summarization and clustering progress</li> <li>Duplicate group and recurring topic counts</li> <li>Last 24 hours activity</li> </ul>"},{"location":"development/","title":"Development","text":"<ul> <li>Testing -- running Minitest specs</li> <li>Contributing -- how to contribute</li> </ul>"},{"location":"development/#setup","title":"Setup","text":"<pre><code>git clone https://github.com/madbomber/my_news.git\ncd my_news\nbundle install\n</code></pre>"},{"location":"development/#project-structure","title":"Project Structure","text":"<pre><code>lib/my_news/\n\u251c\u2500\u2500 cli.rb              # Thor CLI commands\n\u251c\u2500\u2500 config.rb           # Configuration via myway_config\n\u251c\u2500\u2500 db.rb               # SQLite + Sequel setup\n\u251c\u2500\u2500 version.rb\n\u251c\u2500\u2500 config/\n\u2502   \u2514\u2500\u2500 defaults.yml    # Default settings\n\u251c\u2500\u2500 models/             # Sequel models\n\u2502   \u251c\u2500\u2500 feed.rb\n\u2502   \u251c\u2500\u2500 entry.rb\n\u2502   \u251c\u2500\u2500 article.rb\n\u2502   \u2514\u2500\u2500 bulletin.rb\n\u251c\u2500\u2500 fetch/              # Async HTTP fetching\n\u2502   \u251c\u2500\u2500 fetcher.rb\n\u2502   \u251c\u2500\u2500 tor_proxy.rb\n\u2502   \u2514\u2500\u2500 handlers/\n\u2502       \u251c\u2500\u2500 base.rb\n\u2502       \u251c\u2500\u2500 hacker_news.rb\n\u2502       \u2514\u2500\u2500 mastodon.rb\n\u251c\u2500\u2500 normalize/          # Content extraction\n\u2502   \u251c\u2500\u2500 normalizer.rb\n\u2502   \u251c\u2500\u2500 extractor.rb\n\u2502   \u2514\u2500\u2500 converter.rb\n\u251c\u2500\u2500 summarize/          # LLM summarization\n\u2502   \u251c\u2500\u2500 summarizer.rb\n\u2502   \u2514\u2500\u2500 llm_config.rb\n\u251c\u2500\u2500 cluster/            # Deduplication\n\u2502   \u251c\u2500\u2500 simhash.rb\n\u2502   \u251c\u2500\u2500 deduplicator.rb\n\u2502   \u2514\u2500\u2500 recurrence.rb\n\u2514\u2500\u2500 publish/            # Output generation\n    \u251c\u2500\u2500 publisher.rb\n    \u251c\u2500\u2500 bulletin_builder.rb\n    \u251c\u2500\u2500 file_writer.rb\n    \u251c\u2500\u2500 freshrss.rb\n    \u2514\u2500\u2500 scheduler.rb\n</code></pre>"},{"location":"development/contributing/","title":"Contributing","text":""},{"location":"development/contributing/#getting-started","title":"Getting Started","text":"<ol> <li>Fork the repository</li> <li>Create a feature branch: <code>git checkout -b my-feature</code></li> <li>Make your changes</li> <li>Run tests: <code>bundle exec rake test</code></li> <li>Submit a pull request</li> </ol>"},{"location":"development/contributing/#guidelines","title":"Guidelines","text":"<ul> <li>Follow existing code style and patterns</li> <li>Add tests for new functionality</li> <li>Use <code>debug_me</code> instead of <code>puts</code> for debugging output</li> <li>Keep commits focused and use conventional commit messages</li> </ul>"},{"location":"development/contributing/#dependencies","title":"Dependencies","text":"<p>Add runtime dependencies to <code>my_news.gemspec</code>. Development/test dependencies go in the <code>Gemfile</code>.</p>"},{"location":"development/contributing/#reporting-issues","title":"Reporting Issues","text":"<p>Open an issue at github.com/madbomber/my_news/issues.</p>"},{"location":"development/testing/","title":"Testing","text":"<p>MyNews uses Minitest. Tests live in the <code>test/</code> directory.</p>"},{"location":"development/testing/#running-tests","title":"Running Tests","text":"<pre><code># Run all tests\nbundle exec rake test\n\n# Or equivalently\nbundle exec rake\n\n# Run a single test file\nbundle exec ruby test/test_my_news.rb\n</code></pre>"},{"location":"development/testing/#test-database","title":"Test Database","text":"<p>Tests use an in-memory SQLite database (configured in <code>defaults.yml</code> under the <code>test</code> environment):</p> <pre><code>test:\n  database:\n    path: \":memory:\"\n</code></pre>"},{"location":"development/testing/#writing-tests","title":"Writing Tests","text":"<pre><code>require \"test_helper\"\n\nclass TestMyFeature &lt; Minitest::Test\n  def setup\n    MyNews.setup(env: :test)\n  end\n\n  def test_something\n    assert_equal expected, actual\n  end\nend\n</code></pre>"},{"location":"examples/","title":"Examples","text":"<p>Seven runnable examples in the <code>examples/</code> directory demonstrate each pipeline stage.</p>"},{"location":"examples/#running-examples","title":"Running Examples","text":"<pre><code>bundle exec ruby examples/01_basic_setup.rb\n</code></pre>"},{"location":"examples/#example-list","title":"Example List","text":""},{"location":"examples/#01-basic-setup","title":"01 -- Basic Setup","text":"<p><code>examples/01_basic_setup.rb</code></p> <p>Connects to the database, creates tables, and inspects the schema. Shows how <code>MyNews.setup</code> initializes everything.</p>"},{"location":"examples/#02-single-feed-fetch","title":"02 -- Single Feed Fetch","text":"<p><code>examples/02_single_feed_fetch.rb</code></p> <p>Fetches a single feed (Lobsters), stores entries, and queries results via Sequel models.</p>"},{"location":"examples/#03-full-pipeline-report","title":"03 -- Full Pipeline Report","text":"<p><code>examples/03_full_pipeline_report.rb</code></p> <p>Fetches all configured feeds concurrently. Demonstrates ETag caching behavior across two runs and per-feed statistics.</p>"},{"location":"examples/#04-normalize-entries","title":"04 -- Normalize Entries","text":"<p><code>examples/04_normalize_entries.rb</code></p> <p>Fetches Ars Technica, then normalizes raw HTML entries into clean Markdown articles. Shows before/after content.</p>"},{"location":"examples/#05-summarize-articles","title":"05 -- Summarize Articles","text":"<p><code>examples/05_summarize_articles.rb</code></p> <p>Fetches a feed, normalizes entries, then summarizes articles via the configured LLM. Requires an API key.</p>"},{"location":"examples/#06-cluster-dedup","title":"06 -- Cluster &amp; Dedup","text":"<p><code>examples/06_cluster_dedup.rb</code></p> <p>Seeds synthetic duplicate content to demonstrate SimHash fingerprinting, hamming distance calculation, and cluster assignment.</p>"},{"location":"examples/#07-full-publish","title":"07 -- Full Publish","text":"<p><code>examples/07_full_publish.rb</code></p> <p>Runs the complete pipeline from fetch through publish. Outputs themed bulletins as Markdown and HTML files.</p>"},{"location":"getting-started/","title":"Getting Started","text":"<p>Set up MyNews and run your first pipeline.</p> <ul> <li>Installation -- dependencies and gem setup</li> <li>Quick Start -- fetch, normalize, summarize, cluster, and publish</li> </ul>"},{"location":"getting-started/installation/","title":"Installation","text":""},{"location":"getting-started/installation/#gem-install","title":"Gem Install","text":"<pre><code>gem install my_news\n</code></pre> <p>Or add to your Gemfile:</p> <pre><code>gem \"my_news\"\n</code></pre> <p>Then:</p> <pre><code>bundle install\n</code></pre>"},{"location":"getting-started/installation/#system-dependencies","title":"System Dependencies","text":"<ul> <li>Ruby &gt;= 3.2.0 (managed via <code>rbenv</code>)</li> <li>SQLite3 -- ships with macOS; on Linux: <code>apt install libsqlite3-dev</code></li> </ul>"},{"location":"getting-started/installation/#llm-api-keys","title":"LLM API Keys","text":"<p>Summarization requires at least one LLM provider key set as an environment variable:</p> <pre><code>export ANTHROPIC_API_KEY=\"sk-ant-...\"\n# or\nexport OPENAI_API_KEY=\"sk-...\"\n# or\nexport GEMINI_API_KEY=\"...\"\n</code></pre>"},{"location":"getting-started/installation/#configuration-files","title":"Configuration Files","text":"<p>MyNews looks for configuration in the <code>config/</code> directory:</p> File Purpose <code>config/defaults.yml</code> Built-in defaults (bundled with gem) <code>config/feeds.yml</code> Your feed list with per-feed overrides <code>config/bulletins.yml</code> Theme definitions and publish schedule <p>See Configuration for details.</p>"},{"location":"getting-started/quick-start/","title":"Quick Start","text":""},{"location":"getting-started/quick-start/#1-create-a-feeds-file","title":"1. Create a feeds file","text":"<pre><code># config/feeds.yml\nfeeds:\n  - url: https://lobste.rs/rss\n    name: Lobsters\n  - url: https://feeds.arstechnica.com/arstechnica/index\n    name: Ars Technica\n</code></pre>"},{"location":"getting-started/quick-start/#2-run-the-full-pipeline","title":"2. Run the full pipeline","text":"<pre><code>my_news pipeline\n</code></pre> <p>This runs all five stages in sequence: fetch, normalize, summarize, cluster, publish.</p>"},{"location":"getting-started/quick-start/#3-check-results","title":"3. Check results","text":"<pre><code># View output files\nls output/markdown/\nls output/html/\n\n# Search articles\nmy_news search \"ruby performance\"\n\n# Check pipeline status\nmy_news status\n</code></pre>"},{"location":"getting-started/quick-start/#running-individual-stages","title":"Running Individual Stages","text":"<p>Each stage can be run independently:</p> <pre><code>my_news fetch       # pull feeds, store raw entries\nmy_news normalize   # convert raw HTML to markdown\nmy_news summarize   # generate LLM summaries\nmy_news cluster     # deduplicate and detect recurring topics\nmy_news publish     # build and publish themed bulletins\n</code></pre>"},{"location":"getting-started/quick-start/#interactive-console","title":"Interactive Console","text":"<pre><code>bin/console\n</code></pre> <p>This starts an IRB session with the gem loaded.</p>"},{"location":"guides/","title":"Guides","text":"<p>In-depth guides for configuring and using MyNews.</p> <ul> <li>Configuration -- defaults.yml, feeds.yml, bulletins.yml</li> <li>Feeds -- adding and managing RSS feeds</li> <li>Custom Handlers -- writing per-feed parsing handlers</li> <li>Summarization -- LLM setup and provider configuration</li> <li>Clustering -- SimHash deduplication, recurrence detection</li> <li>Publishing -- file output and FreshRSS integration</li> <li>Scheduling -- 3x/day cron scheduling</li> <li>Tor Proxy -- SOCKS5 proxy for privacy</li> </ul>"},{"location":"guides/clustering/","title":"Clustering","text":"<p>MyNews uses SimHash fingerprinting to deduplicate articles and detect recurring topics.</p>"},{"location":"guides/clustering/#simhash-deduplication","title":"SimHash Deduplication","text":"<p>SimHash generates a 64-bit fingerprint from article text. Articles with fingerprints within a configurable hamming distance are grouped into clusters.</p> Article text \u25b6 Compute SimHash \u25b6 Compare hamming distance \u25b6 Distance &lt; threshold? Yes \u25b6 Same cluster No \u25b6 New cluster"},{"location":"guides/clustering/#how-simhash-works","title":"How SimHash Works","text":"<ol> <li>Tokenize the article text into words</li> <li>Hash each word to a 64-bit value</li> <li>For each bit position, sum +1 (if bit is 1) or -1 (if bit is 0) across all word hashes</li> <li>The final fingerprint has bit N set to 1 if the sum at position N is positive</li> </ol> <p>Two articles are considered duplicates if their SimHash fingerprints differ in fewer than ~3 bit positions (hamming distance).</p>"},{"location":"guides/clustering/#recurring-topic-detection","title":"Recurring Topic Detection","text":"<p>After clustering, the recurrence detector compares today's clusters against articles from the last 3 days. Topics that appear across multiple days are flagged as <code>is_recurring = true</code>.</p> <p>Recurring topics are placed at the end of published bulletins.</p>"},{"location":"guides/clustering/#running","title":"Running","text":"<pre><code>my_news cluster\n</code></pre> <p>This runs both deduplication and recurrence detection.</p>"},{"location":"guides/configuration/","title":"Configuration","text":"<p>MyNews uses <code>myway_config</code> for layered configuration with environment-specific overrides.</p>"},{"location":"guides/configuration/#config-files","title":"Config Files","text":"File Location Purpose <code>defaults.yml</code> Bundled with gem Default settings for all environments <code>feeds.yml</code> <code>config/feeds.yml</code> Feed URLs and per-feed overrides <code>bulletins.yml</code> <code>config/bulletins.yml</code> Theme definitions and publish schedule"},{"location":"guides/configuration/#defaultsyml","title":"defaults.yml","text":"<pre><code>defaults:\n  database:\n    path: db/my_news.db\n\n  fetch:\n    concurrency: 10\n    user_agent: \"MyNews/0.1 (+https://github.com/madbomber/my_news)\"\n    timeout: 30\n    tor:\n      enabled: false\n      host: \"127.0.0.1\"\n      port: 9050\n\n  llm:\n    provider: anthropic\n    model: claude-sonnet-4-20250514\n    max_tokens: 300\n\n  freshrss:\n    url: \"\"\n    username: \"\"\n    api_key: \"\"\n\n  output:\n    markdown_dir: output/markdown\n    html_dir: output/html\n\n  schedule:\n    times:\n      - \"07:00\"\n      - \"13:00\"\n      - \"19:00\"\n    timezone: America/Chicago\n\ndevelopment:\n  database:\n    path: db/my_news_dev.db\n\ntest:\n  database:\n    path: \":memory:\"\n\nproduction:\n  database:\n    path: db/my_news.db\n  fetch:\n    concurrency: 20\n</code></pre>"},{"location":"guides/configuration/#feedsyml","title":"feeds.yml","text":"<pre><code>feeds:\n  - url: https://lobste.rs/rss\n    name: Lobsters\n  - url: https://feeds.arstechnica.com/arstechnica/index\n    name: Ars Technica\n  - url: https://news.ycombinator.com/rss\n    name: Hacker News\n    handler: hacker_news\n</code></pre>"},{"location":"guides/configuration/#bulletinsyml","title":"bulletins.yml","text":"<pre><code>themes:\n  - name: Tech\n    keywords: [ruby, python, javascript, rust, go, programming]\n  - name: AI &amp; ML\n    keywords: [ai, llm, machine learning, neural, gpt, claude]\n  - name: Security\n    keywords: [security, vulnerability, breach, exploit, cve]\n</code></pre>"},{"location":"guides/configuration/#environment-variables","title":"Environment Variables","text":"<p>LLM API keys are read from the environment:</p> Variable Provider <code>ANTHROPIC_API_KEY</code> Anthropic (Claude) <code>OPENAI_API_KEY</code> OpenAI (GPT) <code>GEMINI_API_KEY</code> Google (Gemini)"},{"location":"guides/configuration/#accessing-config-in-code","title":"Accessing Config in Code","text":"<pre><code>MyNews.setup\nconfig = MyNews.config\n\nconfig.database_path      # =&gt; \"db/my_news.db\"\nconfig.fetch_concurrency  # =&gt; 10\nconfig.llm_model          # =&gt; \"claude-sonnet-4-20250514\"\nconfig.schedule_times     # =&gt; [\"07:00\", \"13:00\", \"19:00\"]\nconfig.feeds              # =&gt; [{\"url\" =&gt; \"...\", \"name\" =&gt; \"...\"}]\nconfig.themes             # =&gt; [{\"name\" =&gt; \"Tech\", \"keywords\" =&gt; [...]}]\n</code></pre>"},{"location":"guides/feeds/","title":"Feeds","text":""},{"location":"guides/feeds/#adding-feeds","title":"Adding Feeds","text":""},{"location":"guides/feeds/#via-config-file","title":"Via config file","text":"<p>Add entries to <code>config/feeds.yml</code>:</p> <pre><code>feeds:\n  - url: https://lobste.rs/rss\n    name: Lobsters\n  - url: https://feeds.arstechnica.com/arstechnica/index\n    name: Ars Technica\n  - url: https://news.ycombinator.com/rss\n    name: Hacker News\n    handler: hacker_news\n</code></pre>"},{"location":"guides/feeds/#via-cli","title":"Via CLI","text":"<pre><code>my_news feed_add https://lobste.rs/rss --name \"Lobsters\"\nmy_news feed_add https://news.ycombinator.com/rss --name \"HN\" --handler hacker_news\n</code></pre>"},{"location":"guides/feeds/#managing-feeds","title":"Managing Feeds","text":"<pre><code># List all enabled feeds\nmy_news feeds\n\n# Include disabled feeds\nmy_news feeds --all\n\n# Toggle a feed on/off\nmy_news feed_toggle https://lobste.rs/rss\n\n# Remove a feed and its entries\nmy_news feed_remove https://lobste.rs/rss\n</code></pre>"},{"location":"guides/feeds/#per-feed-options","title":"Per-Feed Options","text":"Option Description <code>url</code> RSS/Atom feed URL (required) <code>name</code> Display name <code>handler</code> Custom handler name (<code>hacker_news</code>, <code>mastodon</code>)"},{"location":"guides/feeds/#etag-caching","title":"ETag Caching","text":"<p>The fetcher stores <code>ETag</code> and <code>Last-Modified</code> headers from each feed response. On subsequent fetches, these are sent back to avoid re-downloading unchanged content. Feeds returning <code>304 Not Modified</code> are skipped.</p>"},{"location":"guides/handlers/","title":"Custom Handlers","text":"<p>Feed handlers customize how specific feeds are parsed. Built-in handlers exist for Hacker News and Mastodon.</p>"},{"location":"guides/handlers/#built-in-handlers","title":"Built-in Handlers","text":"Handler Feed Type Behavior <code>hacker_news</code> Hacker News RSS Extracts linked article URL, fetches full content <code>mastodon</code> Mastodon/Fediverse Handles toots, thread unwinding"},{"location":"guides/handlers/#writing-a-custom-handler","title":"Writing a Custom Handler","text":"<p>Create a new file in <code>lib/my_news/fetch/handlers/</code>:</p> <pre><code># lib/my_news/fetch/handlers/my_site.rb\nmodule MyNews\n  module Fetch\n    module Handlers\n      class MySite &lt; Base\n        def process(entry)\n          # entry is a parsed RSS item\n          # Return a hash with :title, :url, :raw_html\n          {\n            title:    entry.title,\n            url:      entry.link,\n            raw_html: fetch_full_content(entry.link)\n          }\n        end\n\n        private\n\n        def fetch_full_content(url)\n          # Custom logic to fetch and extract content\n          response = HTTP.get(url)\n          response.body.to_s\n        end\n      end\n    end\n  end\nend\n</code></pre>"},{"location":"guides/handlers/#registering-a-handler","title":"Registering a Handler","text":"<p>Reference the handler by its snake_case name in <code>feeds.yml</code>:</p> <pre><code>feeds:\n  - url: https://my-site.com/feed.xml\n    name: My Site\n    handler: my_site\n</code></pre> <p>The handler class name is derived by converting <code>my_site</code> to <code>MySite</code> and looking in the <code>Handlers</code> namespace.</p>"},{"location":"guides/publishing/","title":"Publishing","text":"<p>The publish stage assembles clustered articles into themed bulletins and outputs them to files and FreshRSS.</p>"},{"location":"guides/publishing/#output-formats","title":"Output Formats","text":""},{"location":"guides/publishing/#markdown-files","title":"Markdown Files","text":"<p>Written to <code>output/markdown/</code> (configurable):</p> <pre><code>output/markdown/2025-01-27_morning_tech.md\noutput/markdown/2025-01-27_morning_ai.md\n</code></pre>"},{"location":"guides/publishing/#html-files","title":"HTML Files","text":"<p>Written to <code>output/html/</code> (configurable):</p> <pre><code>output/html/2025-01-27_morning_tech.html\noutput/html/2025-01-27_morning_ai.html\n</code></pre>"},{"location":"guides/publishing/#freshrss-integration","title":"FreshRSS Integration","text":"<p>MyNews pushes bulletins to FreshRSS via the Fever API.</p> <p>Configure in <code>defaults.yml</code>:</p> <pre><code>freshrss:\n  url: \"https://freshrss.example.com/api/fever.php\"\n  username: \"your_username\"\n  api_key: \"your_api_key\"\n</code></pre>"},{"location":"guides/publishing/#bulletin-structure","title":"Bulletin Structure","text":"<p>Each bulletin is organized by theme (defined in <code>bulletins.yml</code>):</p> <ol> <li>New articles matching theme keywords, grouped by cluster</li> <li>Recurring topics appended at the end</li> </ol>"},{"location":"guides/publishing/#running","title":"Running","text":"<pre><code>my_news publish\n</code></pre>"},{"location":"guides/scheduling/","title":"Scheduling","text":"<p>MyNews supports automatic pipeline execution on a cron schedule using <code>rufus-scheduler</code>.</p>"},{"location":"guides/scheduling/#default-schedule","title":"Default Schedule","text":"<p>The pipeline runs 3x daily by default:</p> <pre><code>schedule:\n  times:\n    - \"07:00\"\n    - \"13:00\"\n    - \"19:00\"\n  timezone: America/Chicago\n</code></pre>"},{"location":"guides/scheduling/#running-the-scheduler","title":"Running the Scheduler","text":"<pre><code>my_news schedule\n</code></pre> <p>This starts a long-running process that executes the full pipeline at each scheduled time. It runs in the foreground -- use a process manager (systemd, launchd, etc.) for production.</p>"},{"location":"guides/scheduling/#custom-schedule","title":"Custom Schedule","text":"<p>Override the times in your configuration:</p> <pre><code>schedule:\n  times:\n    - \"06:00\"\n    - \"12:00\"\n    - \"18:00\"\n    - \"22:00\"\n  timezone: America/New_York\n</code></pre>"},{"location":"guides/scheduling/#alternative-system-cron","title":"Alternative: System Cron","text":"<p>Instead of the built-in scheduler, you can use crontab:</p> <pre><code>0 7,13,19 * * * cd /path/to/my_news &amp;&amp; bundle exec my_news pipeline\n</code></pre>"},{"location":"guides/summarization/","title":"Summarization","text":"<p>MyNews uses the <code>ruby_llm</code> gem for unified access to multiple LLM providers.</p>"},{"location":"guides/summarization/#supported-providers","title":"Supported Providers","text":"Provider Env Variable Example Model Anthropic <code>ANTHROPIC_API_KEY</code> <code>claude-sonnet-4-20250514</code> OpenAI <code>OPENAI_API_KEY</code> <code>gpt-4o</code> Google <code>GEMINI_API_KEY</code> <code>gemini-2.0-flash</code>"},{"location":"guides/summarization/#configuration","title":"Configuration","text":"<p>In <code>defaults.yml</code>:</p> <pre><code>llm:\n  provider: anthropic\n  model: claude-sonnet-4-20250514\n  max_tokens: 300\n</code></pre>"},{"location":"guides/summarization/#how-it-works","title":"How It Works","text":"<ol> <li>The summarizer loads unsummarized articles from the database</li> <li>Each article's markdown content is sent to the configured LLM</li> <li>A system prompt styled as an Economist editor guides the summary format</li> <li>The concise summary is stored on the <code>Article</code> record</li> </ol> <pre><code># Internal flow\nchat = RubyLLM.chat(model: config.llm_model)\nchat.with_instructions(system_prompt)\nresponse = chat.ask(\"Summarize this article concisely:\\n\\n#{markdown}\")\narticle.update(summary: response.content)\n</code></pre>"},{"location":"guides/summarization/#system-prompt","title":"System Prompt","text":"<p>The summarization prompt is stored in <code>prompts/economist_editor.md</code> and instructs the LLM to produce concise, informative summaries in the style of The Economist.</p>"},{"location":"guides/summarization/#running","title":"Running","text":"<pre><code>my_news summarize\n</code></pre> <p>This processes all articles that don't yet have a summary.</p>"},{"location":"guides/tor-proxy/","title":"Tor Proxy","text":"<p>MyNews can route feed fetches through a Tor SOCKS5 proxy for privacy.</p>"},{"location":"guides/tor-proxy/#setup","title":"Setup","text":"<p>Install Tor:</p> macOSLinux <pre><code>brew install tor\nbrew services start tor\n</code></pre> <pre><code>sudo apt install tor\nsudo systemctl start tor\n</code></pre> <p>Tor listens on <code>127.0.0.1:9050</code> by default.</p>"},{"location":"guides/tor-proxy/#configuration","title":"Configuration","text":"<p>Enable in <code>defaults.yml</code>:</p> <pre><code>fetch:\n  tor:\n    enabled: true\n    host: \"127.0.0.1\"\n    port: 9050\n</code></pre>"},{"location":"guides/tor-proxy/#how-it-works","title":"How It Works","text":"<p>When enabled, the <code>TorProxy</code> class wraps HTTP requests through a SOCKS5 proxy. All feed fetches are routed through Tor, hiding your IP from feed servers.</p> <p>The proxy is managed in <code>lib/my_news/fetch/tor_proxy.rb</code>.</p>"}]}